!function(t){Vue.component("fe-certificates",{data:function(){return{isActiveX:""}},mounted:function(){this.isActiveX=t(this.$el).find('.themes .attachment[data-active="1"]').attr("data-id")},methods:{isActive:function(t){return t==this.isActiveX},getCertificateContainer:function(e){return t(this.$el).find("#certificate-"+e)},_assign:function(e,i,s){e.preventDefault();var n=this;t.ajax({url:"",data:{"lp-ajax":"update-course-certificate",course_id:i,cert_id:s},success:function(){var t=n.getCertificateContainer(s).addClass("active");t.parent().prepend(t),n.isActiveX=s}})},_remove:function(e,i,s){var n=this;e.preventDefault(),t.ajax({url:"",data:{"lp-ajax":"update-course-certificate",course_id:i,cert_id:0},success:function(){n.isActiveX=""}})},_openEdit:function(e){e.preventDefault(),window.location.href=t(e.target).data("href")}}}),Vue.component("fe-content-drip-items",{props:["courseData","sections"],data:function(){return{dripItems:{},itemsConfig:{},dripType:"",status:"",showModal:!1,quickSettings:{start:1,step:1,type:"minute"}}},watch:{sections:{handler:function(){this.syncItems()},deep:!0}},created:function(){this.parseConfig()},mounted:function(){var e=this;this.parseConfig(),this.syncItems(),t(document).on("FE.editor-rendered",FE_Helpers.debounce(function(){e.xxx()},2e3)),window["fe-content-drip-items"]=this},methods:{parseConfig:function(){this.itemsConfig=JSON.parse(t("#fe-drip-content-items-config").html()),this.dripType=this.itemsConfig.dripType},syncItems:function(){var e=this,i={};this.sections.forEach(function(s){s.items.forEach(function(s){var n={id:s.id,title:s.title,type:s.type};e.dripItems["item_"+s.id]?n=t.extend({},e.dripItems["item_"+s.id],n):n.settings=e.getItemConfig(s),i["item_"+s.id]=n})}),this.dripItems=i,Vue.nextTick(function(){e.xxx()})},xxx:function(){t(this.$el).find(".item-datepicker").datetimepicker({timeFormat:"HH:mm",dateFormat:"mm/dd/yy",onSelect:function(e,i){i.id?FE_Helpers.fireNativeEvent(t("#"+i.id)[0],"input"):FE_Helpers.fireNativeEvent(t("#"+i.inst.id)[0],"input")}}),this.$refs.prerequisite&&(t.isArray(this.$refs.prerequisite)?this.$refs.prerequisite.forEach(function(t){FE_Helpers.select2(t)}):FE_Helpers.select2(this.$refs.prerequisite))},getItemConfig:function(e){var i={type:"immediately",delay_interval_0:0,delay_interval_1:"minute",date:(new Date).toLocaleDateString()+" "+(new Date).toLocaleTimeString(),prerequisite:[]},s=this.itemsConfig.dripItems[e.id];return s&&(s.interval&&(i.delay_interval_0=s.interval[0],i.delay_interval_1=s.interval[1]),s.type&&(i.type=s.type),s.date&&(i.date=s.date),s.prerequisite&&(i.prerequisite=t.isArray(s.prerequisite)?s.prerequisite.map(function(t){return parseInt(t)}):[])),i},isPrerequisite:function(){return this.courseData&&Object.values(this.courseData).length?"prerequisite"==this.courseData._lp_content_drip_drip_type:"prerequisite"===this.dripType},isSelectedItem:function(e,i,s,n){var r,a=Object.values(this.dripItems),d=t.isArray(e.settings.prerequisite)&&e.settings.prerequisite.length?e.settings.prerequisite:(r=a.findIndex(function(t){return t.id==e.id}))>0?[a[r-1].id]:[];return-1!==t.inArray(s.id,d.map(function(t){return parseInt(t)}))},getButtonUpdateLabel:function(e){return t(this.$refs["btn-update"]).data("updating"===this.status?"text-update":"text")},_updateSettings:function(t){var e=parseInt(this.quickSettings.start);for(var i in this.dripItems)this.dripItems.hasOwnProperty(i)&&(this.dripItems[i].settings.type="interval",this.dripItems[i].settings.delay_interval_0=e,this.dripItems[i].settings.delay_interval_1=this.quickSettings.type,e+=parseInt(this.quickSettings.step))},_reset:function(t){for(var e in t.preventDefault(),this.dripItems)this.dripItems.hasOwnProperty(e)&&(this.dripItems[e].settings.type="immediately",this.dripItems[e].settings.delay_interval_0=0,this.dripItems[e].settings.delay_interval_1="minute")},_showModal:function(t){t.preventDefault(),this.showModal=!0},_save:function(e,i){if(this.dripItems){this.status="updating";var s,n,r=this,a={};for(n in this.dripItems)this.dripItems.hasOwnProperty(n)&&(a[(s=this.dripItems[n]).id]={type:s.settings.type||"immediately",interval:[s.settings.delay_interval_0||0,s.settings.delay_interval_1||"minute"],prerequisite:s.settings.prerequisite?s.settings.prerequisite.map(function(t){return parseInt(t)}):[],date:s.settings.date});t.ajax({url:lpGlobalSettings.ajax+"?action=e_update_content_drip_settings",data:{courseId:i,"item-delay":a},type:"post",success:function(){r.status=""},error:function(){r.status=""}})}},_close:function(){this.showModal=!1}}})}(jQuery);