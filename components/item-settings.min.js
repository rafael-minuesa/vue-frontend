!function(t){"use strict";Vue.component("e-course-item-settings",{template:"#tmpl-e-course-item-settings",props:["section","item","itemData","request","content"],data:function(){return{dataChanged:!1,$prevItem:!1,$nextItem:!1}},watch:{itemData:{handler:function(t){var e=this;return e.dataChanged=!0,Vue.nextTick(function(){e.dataChanged=!1}),t},deep:!0},"itemData.id":function(){t(this.$el).removeAttr("class").scrollTop(0)},"itemData.settings":{handler:function(t){this.updateItemSettings()},deep:!0}},computed:{title:function(){return this.item.title}},created:function(){},mounted:function(){this._mounted=!0},methods:t.extend({},FE_Base.Store_Methods,{updateItemSettings:FE_Helpers.debounce(function(){FE_Helpers.Course_Editor_Request("","update-post-meta",{postMeta:this.itemData.settings,post_ID:this.itemData.id}).then(function(t){})},300,this),getContext:function(){return this.itemData?this.itemData.type:""},hasPrevItem:function(){return this.getNavItems(),this.$prevItem},hasNextItem:function(){return this.getNavItems(),this.$nextItem},close:function(t){t.preventDefault(),this.$emit("closeItemSettings",this),this.$parent.closeItemSettings()},getNavItems:function(){if(this.item);},getNavItemText:function(t){return"prev"===t&&this.$prevItem?this.$prevItem.item.title:!!this.$nextItem&&this.$nextItem.item.title},getItemName:function(){var t=this,e=this.$dataStore("course_item_types").find(function(e){return e.type==t.itemData.type});return e?e.name:this.itemData.id},nextItem:function(){this.$nextItem&&(this.item=this.$nextItem,this.itemData=this.item.item),this.getNavItems()},prevItem:function(){this.$prevItem&&(this.item=this.$prevItem,this.itemData=this.item.item),this.getNavItems()},getComponentItemSettings:function(){return"e-item-settings-"+this.itemData.type},update:function(e){var i=this.item.getSection();this.request("","update-item-settings",{section_ID:i.id,item_ID:this.itemData.id,settings:this.getItemSettings(),position:this.item.getPosition()+1}).then(t.proxy(function(i){this.updateComplete(i),t.isFunction(e)&&e.apply(this,i)},this))},apply:function(t){},updateComplete:function(t){var e=t||{};"error"!==e.result&&(this.itemData.id=e.item.id)},getFormattedId:function(){return this.itemData.id?"#"+this.itemData.id:"#####"},getItemSettings:function(){var e=FE_Helpers.clone(this.itemData.settings)||{};delete e.__FIELDS__,e.__title=this.itemData.title,e.__content=this.itemData.content,e.__type=this.itemData.type;t(document).triggerHandler("e-item-settings",e);return e},enableGeneralSettings:function(){return"lp_quiz"!==this.itemData.type},_updateSettings:function(){}})}),Vue.component("e-form-field",{props:["field","item","itemData","settings"],template:"#tmpl-e-form-field",computed:{},methods:{includeFormField:function(t){var e={number:"text"},i=(t=t||this.field).type.replace(/_/,"-");return e[i]?(t.xType=i,t.type=e[i]):t.type=i,"e-form-field-"+t.type}}});var e=t.extend({},FE_Base.Store_Methods,{loadSettings:function(t){},includeFormField:function(t){var e={number:"text"},i=t.type.replace(/_/,"-");return e[i]?(t.xType=i,t.type=e[i]):t.type=i,"e-form-field-"+t.type},redraw:function(){var t=this;t.drawComponent=!1,Vue.nextTick(function(){t.drawComponent=!0})},vueId:function(){return this._uid},getSettings:function(t){return t&&this.itemData.settings?this.itemData.settings[t]:this.itemData.settings},getFields:function(t){return this.$dataStore().post_type_fields[t]},loadSettingsCallback:function(t){var e=t.__CONTENT__;delete t.__CONTENT__,this.itemData.settings=t,this.itemData.content=e},isEmptySettings:function(){var e=this.itemData.settings;return!e||t.isPlainObject(e)&&t.isEmptyObject(e)||t.isArray(e)&&0===e.length}}),i={template:"#tmpl-e-course-item-settings-lp_lesson",props:["item","itemData","request"],data:function(){return{drawComponent:!0,settings:this.itemData.settings||{}}},computed:{settings:function(){return this.itemData.settings||{}}},watch:{"itemData.id":function(){this.redraw()}},created:function(){this.loadSettings(this.loadSettingsCallback)},methods:t.extend({},e,{})},n=t.extend({},i,{template:"#tmpl-e-course-item-settings-lp_quiz",name:"e-item-settings-lp_quiz"});Vue.component("e-item-settings-lp_lesson",i),n.watch=t.extend(n.watch||{},{"question.id":function(e){if(e){var i=t(this.$el).addClass("is-showing-question").closest("#e-item-settings").addClass("editing-question");this.$nextTick(function(){t(this.$el).find(".e-edit-question-form").css({top:i.scrollTop(),height:i.height()})})}else t(this.$el).removeClass("is-showing-question").closest("#e-item-settings").removeClass("editing-question"),t(this.$el).find(".e-edit-question-form").css("top","")},"itemData.id":function(t){this.redraw()}}),n.data=function(){return{drawComponent:!0,currentTab:"settings",settings:this.itemData.settings||{},question:null,xTitle:"",showSettingsBox:!1}},n.computed={settings:function(){return this.itemData.settings||{}},xTitle:function(){return this.question?this.question.title:""}},n.mounted=function(){var e=this;t(window).on("resize.resize-question-editor",FE_Helpers.debounce(function(){if(e.question&&e.question.id){var i=t(e.$el).closest("#e-item-settings");t(e.$el).find(".e-edit-question-form").css({top:i.scrollTop(),height:i.height()})}},300,this))},n.methods=t.extend(n.methods,{selectTab:function(e){e.preventDefault();var i=t(e.target).attr("data-tab");i&&(this.currentTab=i,this.xTitle="")},isCurrent:function(t){return this.currentTab===t},getTabTitle:function(t){return"questions"===t.id&&this.isCurrent(t.id)?this.xTitle:t.title},isVisibleTab:function(t){return"questions"!==t.id||!this.xTitle},_setEditQuestion:function(t){isNaN(t)||(t=this.itemData.questions?this.itemData.questions.find(function(e){return e.id==t}):null),t&&(this.question=t,this.xTitle=t?t.title:null)},isEditingQuestion:function(){return this.question},_closeQuestion:function(t){t&&t.preventDefault(),this.question=!1,FE_Helpers.removeQueryVar("question")},updateQuestion:function(){},_updateSettings:function(){},loadQuestion:function(e,i){"position"===i&&this._setEditQuestion(this.itemData.questions[e]),t(this.$el).find(".e-edit-question-form").scrollTop(0)}}),Vue.component("e-item-settings-lp_quiz",n),Vue.component("e-item-settings-general",{template:"#tmpl-e-course-item-settings-basic",props:["item","itemData","request"],watch:{itemData:function(){}}})}(jQuery);