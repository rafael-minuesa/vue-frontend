!function(t){"use strict";Vue.component("e-course-curriculum",{template:"#tmpl-e-course-curriculum",props:["sections","item","store"],computed:{},watch:{sections:{handler:function(){this.sections.filter(function(t){var e=void 0===t.id;return e&&(t.id=LP.uniqueId()),e})},deep:!0}},mounted:function(){this.$section=null,t(this.$el).find(".e-course-sections").sortable({axis:"y",handle:".e-section-head .sort",items:".e-section:not(.placeholder)",update:t.proxy(function(t,e){this.updateSectionsOrderFromView()},this)}),t(window).on("resize.frontend-editor-settings",this.resize).trigger("resize")},methods:t.extend({},FE_Base.Store_Methods,{clickMe:function(){},resize:FE_Helpers.debounce(function(e){var i=t("#e-tab-content-curriculum");i.css({height:t(window).height()-(i.offset().top-t(window).scrollTop())})},100),onFocusSection:function(e){this.$section=e;var i=t(e.$el).find(".section-title");t(".section-title").not(i).each(function(){var e=t(this).data("$instance");e&&e.onBlur()})},onBlurSection:function(t){},moveNextInput:function(){var e=t(this.$section.$el).next().find(".section-title").focus();e.length?e.data("$instance").onFocus():this.addNewSection()},onPressTitle:function(t){this.$emit("pressTitle",t,FE_Helpers.getKeyboard(t))},onPressTitleCallback:FE_Helpers.debounce(function(t){this.$emit("pressTitle",t,FE_Helpers.getKeyboard(t))},10,this),addNewSection:function(e,i){(void 0===e||e<0)&&(e=this.sections.length),i=t.extend({id:LP.uniqueId(),title:"",items:[]},i||{}),this.sections.splice(e,0,i);var n=this;return new Promise(function(t,e){FE_Helpers.debounce(function(){t(n.getSection(i.id))},100)()})},openItemSettings:function(t,e){this.$emit("openItemSettings",t,e),this.$parent.openItemSettings(t,e)},getSection:function(t){return this.$('.e-section[data-id="'+t+'"]').find(".section-title").data("$instance")},moveSection:function(e){var i=e[0],n=e[1],s=t(this.$el).find('.e-section[data-id="'+i.section.id+'"]'),o=s.parent().children(),c=null;(c="up"===n?e[2]?o.first():s.prev():e[2]?o.last():s.next()).length&&("up"===n?s.insertBefore(c):s.insertAfter(c),this.updateSectionsOrderFromView())},updateSectionsOrderFromView:function(e){e||(e=t(this.$el).find(".e-section")),this.$dataStore().sections=FE_Helpers.sortArrayByDOM(this.$dataStore().sections,"","id",e),this.$dispatch("updateSectionsOrder",{sections:this.$dataStore().sections})},countItems:function(){var e=0;return t.each(this.$dataStore().sections,function(){e+=this.items.length}),e},onAddedItem:function(t,e){this.$root.item=t},_addNewSection:function(e){var i=t(e[0].target).closest(".e-section"),n=i.parent().children().index(i);this.addNewSection(n+1)},_deleteSection:function(e){var i=t(e[0].target).closest(".e-section").attr("data-id");this.$store().dispatch("removeSection",{section_ID:i,trash_items:e[1]}).then(t.proxy(function(t){this.$store().commit("removeSection",{section_ID:i})},this))},_toggleSections:function(){var e=[];t(this.$el).find(".e-section").each(function(){var i=t(this);i.hasClass("closed")&&e.push(i.attr("data-id"))}),this.$dataStore().admin_hidden_sections=e,this.$dispatch("updateHiddenSections",e)},_deleteItem:function(t){this.item&&this.item.id==t.id&&setTimeout(function(e){e.item=null,e.$parent.item=null,LP.setUrl(window.location.href.replace(t.id+"/",""))},300,this)}})})}(jQuery);